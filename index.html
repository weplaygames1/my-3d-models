<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TheBros 3D Vault - Pro</title>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
    <style>
        body { margin: 0; background: #121212; color: white; font-family: sans-serif; overflow: hidden; }
        
        /* Login Screen */
        #login-screen {
            position: fixed; width: 100%; height: 100%; background: #1a1a1a;
            display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000;
        }
        input[type="password"] { 
            padding: 15px; border-radius: 8px; border: 2px solid #333; 
            margin-bottom: 15px; background: #222; color: white; width: 250px; text-align: center; font-size: 16px;
        }
        .login-btn { 
            padding: 15px 30px; cursor: pointer; background: #3498db; color: white; 
            border: none; border-radius: 8px; font-weight: bold; width: 284px; font-size: 16px;
        }

        /* App View */
        #app-container { display: none; width: 100vw; height: 100vh; position: relative; }
        model-viewer { width: 100%; height: 100%; background-color: #121212; }

        /* UI Overlay for Controls */
        .ui-overlay {
            position: absolute; bottom: 30px; width: 100%; 
            display: flex; flex-direction: column; align-items: center; gap: 15px;
            z-index: 500; pointer-events: none;
        }
        .controls-row { display: flex; gap: 10px; pointer-events: auto; flex-wrap: wrap; justify-content: center; }
        
        select, .action-btn {
            padding: 12px 20px; border-radius: 10px; background: #333; color: white;
            border: 2px solid #444; font-weight: bold; cursor: pointer; font-size: 14px;
            text-decoration: none; display: flex; align-items: center;
        }

        .import-btn { background: #8e44ad; border-color: #9b59b6; }
        .download-btn { background: #27ae60; border-color: #2ecc71; }
        
        #fileInput { display: none; }
    </style>
</head>
<body>

    <div id="login-screen">
        <h1>THE BROS 3D HUB</h1>
        <input type="password" id="passInput" placeholder="Password">
        <button class="login-btn" id="accessBtn">ACCESS HUB</button>
        <p id="error-msg" style="color: #e74c3c; margin-top: 15px;"></p>
    </div>

    <div id="app-container">
        <model-viewer id="viewer" src="all items.3mf" camera-controls auto-rotate shadow-intensity="1" ar></model-viewer>

        <div class="ui-overlay">
            <div class="controls-row">
                <select id="modelSelect">
                    <option value="all items.3mf">Default: All Items</option>
                    </select>

                <button class="action-btn import-btn" onclick="document.getElementById('fileInput').click()">
                    ðŸ“‚ IMPORT FILE
                </button>
                <input type="file" id="fileInput" accept=".3mf,.glb,.gltf">

                <a id="dlLink" href="all items.3mf" download class="action-btn download-btn">ðŸ“¥ DOWNLOAD</a>
            </div>
        </div>
    </div>

    <script>
        const accessBtn = document.getElementById('accessBtn');
        const passInput = document.getElementById('passInput');
        const modelSelect = document.getElementById('modelSelect');
        const fileInput = document.getElementById('fileInput');
        const viewer = document.getElementById('viewer');
        const dlLink = document.getElementById('dlLink');

        // Login Logic
        function tryLogin() {
            if (passInput.value === "thebros") {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('app-container').style.display = 'block';
            } else {
                document.getElementById('error-msg').innerText = "Wrong password, bro.";
            }
        }

        accessBtn.addEventListener('click', tryLogin);
        passInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') tryLogin(); });

        // Gallery Switcher
        modelSelect.onchange = function() {
            viewer.src = this.value;
            dlLink.href = this.value;
            dlLink.download = this.value;
        };

        // --- NEW IMPORT FUNCTION ---
        fileInput.onchange = function(event) {
            const file = event.target.files[0];
            if (file) {
                // Create a temporary path for the local file
                const url = URL.createObjectURL(file);
                
                // Update viewer and download button
                viewer.src = url;
                dlLink.href = url;
                dlLink.download = file.name;
                
                // Add to gallery list so you can find it again
                const newOpt = document.createElement('option');
                newOpt.value = url;
                newOpt.text = "Imported: " + file.name;
                newOpt.selected = true;
                modelSelect.appendChild(newOpt);
            }
        };
    </script>
</body>
</html>
